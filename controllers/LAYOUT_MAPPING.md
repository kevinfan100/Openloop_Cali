# Layout Template åº§æ¨™å°æ‡‰è¡¨

é€™å€‹æ–‡ä»¶è¨˜éŒ„äº† `create_flux_controller_type3.m` ä¸­èˆŠåº§æ¨™èˆ‡ `layout_template.m` æ–°åº§æ¨™çš„å°æ‡‰é—œä¿‚ã€‚

---

## âœ… å·²å®Œæˆçš„åº§æ¨™æ›¿æ›

### **Section 1: è¼¸å…¥ç«¯å£**

| Block | èˆŠåº§æ¨™ | æ–°åº§æ¨™ (layout_template) |
|-------|--------|-------------------------|
| **Vd** |  |  |
| X | `input_x = 100` | `layout.x.input = 105` |
| Y | `vd_y-10 = 90` | `layout.y.input_vd-10 = 90` |
| **Vm** |  |  |
| X | `input_x = 100` | `layout.x.input = 105` |
| Y | `vm_y-10 = 190` | `layout.y.input_vm-10 = 150` |

**æ”¹è®Š**: X åº§æ¨™å¾ 100 â†’ 105ï¼ŒVm çš„ Y å¾ 200 â†’ 160

---

### **Section 2: èª¤å·®è¨ˆç®—**

| Block | èˆŠåº§æ¨™ | æ–°åº§æ¨™ (layout_template) |
|-------|--------|-------------------------|
| **Vd_Delay** |  |  |
| X | `delay_x-50 = 450` | `layout.x.delays = 450` |
| Y | `vd_y-15 = 85` | `layout.y.ff_vd_delay-15 = 85` |
| **Error_Calc** |  |  |
| X | `error_x = 300` | `layout.x.error_calc = 290` |
| Y | `error_y-15 = 135` | `layout.y.error-15 = 137` |

**æ”¹è®Š**: Error_Calc çš„ X å¾ 300 â†’ 290

---

### **Section 3: å‰é¥‹é …**

| Block | èˆŠåº§æ¨™ | æ–°åº§æ¨™ (layout_template) |
|-------|--------|-------------------------|
| **Vd_Delay2** |  |  |
| X | `delay_x+50 = 550` | `layout.x.delays_2nd = 550` |
| Y | `vd_y-15 = 85` | `layout.y.ff_vd_delay-15 = 85` |
| **Gain_a1** |  |  |
| X | `ff_x-50 = 650` | `layout.x.ff_gain_a1 = 820` |
| Y | `ff_y-15 = 285` | `layout.y.ff_gain_a1-15 = 195` |
| **Gain_a2** |  |  |
| X | `ff_x-50 = 650` | `layout.x.ff_gain_a2 = 765` |
| Y | `ff_y+30-15 = 315` | `layout.y.ff_gain_a2-15 = 265` |
| **FF_Sum** |  |  |
| X | `ff_x+50 = 750` | `layout.x.ff_fb_sum = 915` |
| Y | `ff_y-15 = 285` | `layout.y.ff_sum-15 = 195` |

**æ”¹è®Š**: å‰é¥‹æ¨¡çµ„çš„ X åº§æ¨™å¤§å¹…èª¿æ•´ï¼Œå¾ 650-750 â†’ 765-915

---

### **Section 4: ä¼°æ¸¬å™¨**

#### **Innovation**
| èˆŠåº§æ¨™ | æ–°åº§æ¨™ |
|--------|--------|
| X: `est_x-100 = 600` | `layout.x.innovation = 470` |
| Y: `est_y-15 = 485` | `layout.y.innovation-15 = 322` |

**æ”¹è®Š**: ä½ç½®å¤§å¹…èª¿æ•´

#### **ä¼°æ¸¬å™¨å¢ç›Š**
| Block | èˆŠ X | æ–° X | èˆŠ Y | æ–° Y |
|-------|------|------|------|------|
| Gain_l1 | `est_x-50 = 650` | `layout.x.est_gains = 565` | `est_y-15 = 485` | `layout.y.est_l1-15 = 325` |
| Gain_lambda_c | `est_x-50 = 650` | `layout.x.est_gains = 565` | `est_y+40-15 = 525` | `layout.y.est_lambda_c-15 = 375` |
| Gain_l2 | `est_x-50 = 650` | `layout.x.est_gains = 565` | `est_y+100-15 = 585` | `layout.y.est_l2-15 = 440` |
| Gain_l3 | `est_x-50 = 650` | `layout.x.est_gains = 565` | `est_y+160-15 = 645` | `layout.y.est_l3-15 = 525` |

**æ”¹è®Š**: X å¾ 650 â†’ 565ï¼ŒY åº§æ¨™å…¨éƒ¨å‘ä¸Šç§»å‹•

#### **ä¼°æ¸¬å™¨ç‹€æ…‹ï¼ˆSum + Delayï¼‰**
| Block | èˆŠ X (Sum) | æ–° X (Sum) | èˆŠ X (Delay) | æ–° X (Delay) | èˆŠ Y | æ–° Y |
|-------|-----------|-----------|--------------|--------------|------|------|
| S1 | `est_x+20 = 720` | `layout.x.est_sum = 720` | `est_x+80 = 780` | `layout.x.est_delay = 780` | `est_y+20 = 520` | `layout.y.s1_center = 350` |
| S2 | `est_x+20 = 720` | `layout.x.est_sum = 720` | `est_x+80 = 780` | `layout.x.est_delay = 780` | `est_y+100 = 600` | `layout.y.s2_center = 450` |
| WT | `est_x+20 = 720` | `layout.x.est_sum = 720` | `est_x+80 = 780` | `layout.x.est_delay = 780` | `est_y+160 = 660` | `layout.y.wt_center = 535` |

**æ”¹è®Š**: X ä¿æŒä¸è®Šï¼ŒY åº§æ¨™å…¨éƒ¨å‘ä¸Šç§»å‹•ä¸¦æ¨™æº–åŒ–é–“éš”ç‚º 100

---

### **Section 5: åé¥‹é …**

| Block | èˆŠåº§æ¨™ | æ–°åº§æ¨™ |
|-------|--------|--------|
| **FB_Gain1** |  |  |
| X | `fb_x = 700` | `layout.x.fb_gain_1 = 685` |
| Y | `fb_y-15 = 685` | `layout.y.fb_gain_1-15 = 570` |
| **FB_Gain2** |  |  |
| X | `fb_x = 700` | `layout.x.fb_gain_2 = 855` |
| Y | `fb_y+40-15 = 725` | `layout.y.fb_gain_2-15 = 610` |
| **FB_Sum** |  |  |
| X | `fb_x+70 = 770` | `layout.x.ff_fb_sum = 915` |
| Y | `fb_y+20-15 = 705` | `layout.y.fb_sum-15 = 577` |

**æ”¹è®Š**: FB_Gain2 X å¾ 700 â†’ 855ï¼ŒFB_Sum X å¾ 770 â†’ 915

---

### **Section 6: æ§åˆ¶å¾‹**

| Block | èˆŠåº§æ¨™ | æ–°åº§æ¨™ |
|-------|--------|--------|
| **Control_Sum** |  |  |
| X | `control_x-100 = 1000` | `layout.x.control_sum = 1000` |
| Y | `control_y-15 = 485` | `layout.y.control-15 = 405` |
| **B_inv_Gain** |  |  |
| X | `control_x-30 = 1070` | `layout.x.b_inv = 1090` |
| Y | `control_y-15 = 485` | `layout.y.control-15 = 405` |

**æ”¹è®Š**: X å¾®èª¿ï¼ŒY å¾ 500 â†’ 420

---

### **Section 7: è¼¸å‡ºç«¯å£**

| Block | èˆŠåº§æ¨™ | æ–°åº§æ¨™ |
|-------|--------|--------|
| **u (control output)** |  |  |
| X | `output_x = 1300` | `layout.x.output = 1185` |
| Y | `control_y-10 = 490` | `layout.y.output_u-10 = 410` |
| **e (error output)** |  |  |
| X | `output_x = 1300` | `layout.x.output = 1185` |
| Y | `error_y-10 = 140` | `layout.y.output_e-10 = 145` |

**æ”¹è®Š**: X å¾ 1300 â†’ 1185ï¼Œæ•´é«”å‘å·¦ç§»

---

## ğŸ“Š ä¸»è¦æ”¹è®Šç¸½çµ

### **X åº§æ¨™ï¼ˆæ°´å¹³ï¼‰**
```
èˆŠåº§æ¨™:  100  300  450  500  650-770  1000-1070  1300
æ–°åº§æ¨™:  105  290  450  565  685-915  1000-1090  1185
è®ŠåŒ–:    +5   -10   0   +65  +35-+145    -20      -115
```

**ä¸»è¦èª¿æ•´**ï¼š
- è¼¸å…¥å±¤ï¼šå¾®èª¿ +5
- èª¤å·®è¨ˆç®—ï¼šå‘å·¦ -10
- ä¼°æ¸¬å™¨å¢ç›Šï¼šå‘å³ +65
- å‰é¥‹/åé¥‹ï¼šå¤§å¹…å‘å³ +35~+145
- æ§åˆ¶å¾‹ï¼šå¾®èª¿ -20
- è¼¸å‡ºï¼šå‘å·¦ -115

### **Y åº§æ¨™ï¼ˆå‚ç›´ï¼‰**
```
å€åŸŸ          èˆŠ Y ç¯„åœ        æ–° Y ç¯„åœ       è®ŠåŒ–
è¼¸å…¥å±¤       90-210          90-170         Vm å‘ä¸Š
èª¤å·®         135-150         137-168        å¾®èª¿
å‰é¥‹         285-315         195-295        å‘ä¸Š ~90
ä¼°æ¸¬å™¨       485-660         322-555        å¤§å¹…å‘ä¸Š ~160
åé¥‹         685-725         570-640        å‘ä¸Š ~115
æ§åˆ¶å¾‹       485-500         405-435        å‘ä¸Š ~80
```

**ä¸»è¦èª¿æ•´**ï¼šæ•´é«”ä½ˆå±€æ›´ç·Šæ¹Šï¼Œå‚ç›´é–“è·æ›´åˆç†

---

## âœ… ä½¿ç”¨æ–°ä½ˆå±€çš„å„ªé»

1. **å¯¦éš›å°æ‡‰**: æ–°åº§æ¨™åŸºæ–¼ä½ æ‰‹å‹•èª¿æ•´çš„å¯¦éš›æ¨¡å‹
2. **ä¸€è‡´æ€§**: æœªä¾† Type 1, 2 æ§åˆ¶å™¨å¯ä»¥ä½¿ç”¨ç›¸åŒä½ˆå±€
3. **æ˜“ç¶­è­·**: ä¿®æ”¹ `layout_template.m` å³å¯èª¿æ•´æ‰€æœ‰æ§åˆ¶å™¨
4. **æ¨™æº–åŒ–**: ä¼°æ¸¬å™¨ç‹€æ…‹é–“éš”çµ±ä¸€ç‚º 100 åƒç´ 

---

## ğŸ”§ å¦‚ä½•ä½¿ç”¨

```matlab
% å»ºç«‹æ–°æ¨¡å‹æ™‚æœƒè‡ªå‹•è¼‰å…¥æ¨¡æ¿
create_flux_controller_type3()

% è¼¸å‡ºé¡¯ç¤º:
% âœ“ å»ºç«‹æ–°æ¨¡å‹
% âœ“ è¼‰å…¥ä½ˆå±€æ¨¡æ¿
% â–¶ å»ºç«‹è¼¸å…¥ç«¯å£...
% ...
```

æ‰€æœ‰åº§æ¨™éƒ½æœƒè‡ªå‹•å¾ `layout_template()` è®€å–ï¼Œç¢ºä¿èˆ‡å¯¦éš›æ¨¡å‹ä¸€è‡´ã€‚

---

**è¨˜éŒ„æ—¥æœŸ**: 2025-10-11
**å°æ‡‰æ¨¡å‹**: Flux_Controller_Type3.slx (æ‰‹å‹•èª¿æ•´ç‰ˆ)
