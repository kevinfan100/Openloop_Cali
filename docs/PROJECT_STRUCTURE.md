# Project Structure
# Openloop_Cali å°ˆæ¡ˆçµæ§‹èªªæ˜

**Last Updated**: 2025-10-09
**Project**: Digital Control System Framework for MIMO Plant

---

## ğŸ“‚ Directory Structure

```
Openloop_Cali/
â”‚
â”œâ”€â”€ ğŸ“„ Control_System_Framework.slx    # â­ Main Simulink framework
â”œâ”€â”€ ğŸ“„ generate_simulink_framework.m   # Framework generator script
â”‚
â”œâ”€â”€ ğŸ“„ Model_6_6_Continuous_Weighted.m # Plant model definition (36 TFs)
â”œâ”€â”€ ğŸ“„ P1.m ~ P6.m                     # Individual channel plant parameters
â”œâ”€â”€ ğŸ“¦ one_curve_36_results.mat        # â­ Plant fitting results (IMPORTANT!)
â”‚
â”œâ”€â”€ ğŸ“ controllers/                    # Controller Simulink models
â”‚   â”œâ”€â”€ PI_controller.slx
â”‚   â””â”€â”€ (other controller models)
â”‚
â”œâ”€â”€ ğŸ“ scripts/                        # Core MATLAB scripts
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ framework/                  # Simulink interaction scripts
â”‚   â”‚   â”œâ”€â”€ setup_controller.m        # Integrate controller into framework
â”‚   â”‚   â”œâ”€â”€ run_simulation.m          # Run Simulink simulation
â”‚   â”‚   â””â”€â”€ analyze_results.m         # Analyze simulation results
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ design/                     # Controller design scripts
â”‚   â”‚   â”œâ”€â”€ design_PI_frequency.m     # Frequency-domain PI design
â”‚   â”‚   â”œâ”€â”€ analyze_plant_frequency.m # Plant frequency analysis
â”‚   â”‚   â”œâ”€â”€ example_frequency_design.m # Complete design example
â”‚   â”‚   â””â”€â”€ example_run_PI.m          # PI controller test example
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ results/                    # Simulation results & plots
â”‚       â”œâ”€â”€ *.mat                      # Result data files
â”‚       â”œâ”€â”€ *.fig                      # MATLAB figures
â”‚       â””â”€â”€ *.png                      # Exported plots
â”‚
â”œâ”€â”€ ğŸ“ docs/                           # Documentation
â”‚   â”œâ”€â”€ PROJECT_STRUCTURE.md           # This file
â”‚   â”œâ”€â”€ DEVELOPMENT_RULES.md           # Development guidelines
â”‚   â”œâ”€â”€ æ§åˆ¶å™¨é–‹ç™¼èˆ‡Gitç®¡ç†ç­–ç•¥.md
â”‚   â”œâ”€â”€ generate_simulink_framework.md
â”‚   â””â”€â”€ MATLAB_Simulink_äº’å‹•åŸºç¤æ•™å­¸.md
â”‚
â”œâ”€â”€ ğŸ“ Mathematical_Derivation/        # Mathematical theory & derivations
â”‚   â””â”€â”€ (LaTeX/Markdown math documents)
â”‚
â”œâ”€â”€ ğŸ“ Log/                            # Execution logs (not committed)
â”‚
â”œâ”€â”€ ğŸ“„ .gitignore                      # Git ignore rules
â””â”€â”€ ğŸ“„ README.md                       # (To be created)
```

---

## ğŸ¯ File Descriptions

### Root Level Files

#### â­ **Control_System_Framework.slx**
- **Purpose**: Main Simulink model for the control system
- **Interface**:
  - **Inputs**:
    - `From_Vd` (6Ã—1) - Reference signal via Goto/From
    - `From_Vm` (6Ã—1) - Measured signal via Goto/From
    - `u_in` (6Ã—1) - Control signal input port
  - **Outputs**:
    - `Vm` (6Ã—1) - Measured output
- **Contains**: DAC, Plant (36 TFs), ADC, monitoring blocks
- **Generated by**: `generate_simulink_framework.m`

#### **generate_simulink_framework.m**
- **Purpose**: Programmatically creates the Simulink framework
- **Usage**: `generate_simulink_framework()`
- **Prerequisites**: `one_curve_36_results.mat` must exist
- **Output**: `Control_System_Framework.slx`

#### **Model_6_6_Continuous_Weighted.m**
- **Purpose**: Performs plant identification (multi-curve fitting)
- **Output**: `one_curve_36_results.mat`
- **Method**: Fits 36 second-order transfer functions (6Ã—6 MIMO)

#### **P1.m ~ P6.m**
- **Purpose**: Individual plant parameter definitions for each channel
- **Format**: Contains `a1`, `a2`, `b` coefficients for each TF

#### â­ **one_curve_36_results.mat**
- **Purpose**: Stores fitted plant parameters
- **Contents**: `a1_matrix` (6Ã—6), `a2_matrix` (6Ã—6), `b_matrix` (6Ã—6)
- **IMPORTANT**: This file MUST be present for framework generation

---

### Controllers Directory

```
controllers/
â”œâ”€â”€ PI_controller.slx          # PI controller model
â””â”€â”€ (future controllers)
```

**Purpose**: Contains Simulink controller models that can be integrated into the framework

**Integration**: Use `scripts/framework/setup_controller.m` to connect controllers

---

### Scripts Directory

#### ğŸ“ **scripts/framework/**
Scripts for interacting with the Simulink framework.

| File | Purpose | Usage |
|------|---------|-------|
| `setup_controller.m` | Integrate controller into framework | `setup_controller('PI_controller', params)` |
| `run_simulation.m` | Execute Simulink simulation | `results = run_simulation(model_name, sim_time, options)` |
| `analyze_results.m` | Analyze simulation outputs | `perf = analyze_results(sim_results, Vd_ref, options)` |

#### ğŸ“ **scripts/design/**
Scripts for controller design and analysis.

| File | Purpose | Key Function |
|------|---------|--------------|
| `design_PI_frequency.m` | Frequency-domain PI design | `[Kp, Ki, info] = design_PI_frequency(plant_info, wc, PM, options)` |
| `analyze_plant_frequency.m` | Analyze plant frequency response | `plant_info = analyze_plant_frequency(ch_out, ch_in)` |
| `example_frequency_design.m` | Complete design workflow example | Run as script |
| `example_run_PI.m` | PI controller test example | Run as script |

#### ğŸ“ **scripts/results/**
Stores simulation results, plots, and analysis outputs.

- `*.mat` - Simulation data
- `*.fig` - MATLAB figures (editable)
- `*.png` - Exported plots (for reports)

---

### Documentation Directory

```
docs/
â”œâ”€â”€ PROJECT_STRUCTURE.md               # This file
â”œâ”€â”€ DEVELOPMENT_RULES.md               # Coding standards & Git workflow
â”œâ”€â”€ æ§åˆ¶å™¨é–‹ç™¼èˆ‡Gitç®¡ç†ç­–ç•¥.md           # Controller development guide
â”œâ”€â”€ generate_simulink_framework.md     # Framework generation guide
â””â”€â”€ MATLAB_Simulink_äº’å‹•åŸºç¤æ•™å­¸.md     # MATLAB/Simulink basics
```

**Purpose**: All project documentation, guides, and tutorials.

---

## ğŸ”„ Typical Workflows

### 1. **Generate Framework from Scratch**

```matlab
% Step 1: Run plant identification (if needed)
Model_6_6_Continuous_Weighted

% Step 2: Generate Simulink framework
generate_simulink_framework()

% Step 3: Open and inspect
open_system('Control_System_Framework')
```

### 2. **Design a New Controller**

```matlab
% Step 1: Analyze plant
addpath('scripts/design')
plant_info = analyze_plant_frequency(1, 1);  % Channel 1

% Step 2: Design controller
wc_desired = plant_info.frequency.w_nominal;
PM_desired = 60;  % degrees
[Kp, Ki, design_info] = design_PI_frequency(plant_info, wc_desired, PM_desired);

% Step 3: Build 6Ã—6 parameters
Kp_matrix = diag([Kp, Kp, Kp, Kp, Kp, Kp]);
Ki_matrix = diag([Ki, Ki, Ki, Ki, Ki, Ki]);
```

### 3. **Integrate and Test Controller**

```matlab
% Step 1: Setup controller
addpath('scripts/framework')
params.Kp = Kp_matrix;
params.Ki = Ki_matrix;
params.Ts_controller = 1e-5;
setup_controller('PI_controller', params);

% Step 2: Run simulation
sim_time = 0.01;  % 10 ms
sim_results = run_simulation('Control_System_Framework', sim_time);

% Step 3: Analyze results
Vd_ref = [1; 1; 1; 1; 1; 1];
performance = analyze_results(sim_results, Vd_ref);
```

### 4. **Complete Design Example**

```matlab
% Run the complete workflow
addpath('scripts/design')
example_frequency_design
```

---

## ğŸ“Š Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Plant Identification                                    â”‚
â”‚     Model_6_6_Continuous_Weighted.m                         â”‚
â”‚              â†“                                              â”‚
â”‚     one_curve_36_results.mat (36 TFs)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. Framework Generation                                    â”‚
â”‚     generate_simulink_framework.m                           â”‚
â”‚              â†“                                              â”‚
â”‚     Control_System_Framework.slx                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. Controller Design                                       â”‚
â”‚     analyze_plant_frequency.m (analyze)                     â”‚
â”‚     design_PI_frequency.m (design)                          â”‚
â”‚              â†“                                              â”‚
â”‚     Controller Parameters (Kp, Ki)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. Integration & Simulation                                â”‚
â”‚     setup_controller.m (integrate)                          â”‚
â”‚     run_simulation.m (simulate)                             â”‚
â”‚     analyze_results.m (analyze)                             â”‚
â”‚              â†“                                              â”‚
â”‚     Results (plots, performance metrics)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ Quick Start Guide

### For New Users

1. **Check Prerequisites**
   ```matlab
   % Ensure plant data exists
   if ~exist('one_curve_36_results.mat', 'file')
       error('Run Model_6_6_Continuous_Weighted.m first!');
   end
   ```

2. **Generate Framework**
   ```matlab
   generate_simulink_framework()
   ```

3. **Run Example**
   ```matlab
   addpath('scripts/design')
   example_frequency_design
   ```

### For Development

1. **Read Documentation**
   - [DEVELOPMENT_RULES.md](DEVELOPMENT_RULES.md) - Coding standards
   - [æ§åˆ¶å™¨é–‹ç™¼èˆ‡Gitç®¡ç†ç­–ç•¥.md](æ§åˆ¶å™¨é–‹ç™¼èˆ‡Gitç®¡ç†ç­–ç•¥.md) - Development guide

2. **Follow File Organization**
   - Framework interaction â†’ `scripts/framework/`
   - Controller design â†’ `scripts/design/`
   - Documentation â†’ `docs/`

3. **Use Git Properly**
   - No temporary files (`*_temp.m`, `*_v2.m`)
   - No manual version iterations
   - Follow commit message format

---

## ğŸ“ Notes

### What to Commit
âœ… **Always commit**:
- `Control_System_Framework.slx`
- `one_curve_36_results.mat`
- `P1.m ~ P6.m`
- Core scripts in `scripts/framework/` and `scripts/design/`
- All documentation in `docs/`
- Controllers in `controllers/`

âŒ **Never commit**:
- Temporary files (`*_temp.m`, `*_test.m`, `check_*.m`)
- Version iterations (`*_v2.m`, `*_old.m`)
- Large result files (`.mat`, `.fig` in `scripts/results/`)
- Logs and debug outputs

### Important Files

| File | Purpose | Can Delete? |
|------|---------|-------------|
| `Control_System_Framework.slx` | Main framework | âŒ NO |
| `one_curve_36_results.mat` | Plant parameters | âŒ NO |
| `generate_simulink_framework.m` | Framework generator | âŒ NO |
| `P1.m ~ P6.m` | Plant definitions | âŒ NO |
| `scripts/framework/*.m` | Core framework scripts | âŒ NO |
| `scripts/design/*.m` | Core design scripts | âŒ NO |
| `docs/*.md` | Documentation | âŒ NO |
| `scripts/results/*.mat` | Simulation results | âœ… Yes (after archiving) |
| Log files | Execution logs | âœ… Yes |

---

## ğŸ”— Related Documents

- [DEVELOPMENT_RULES.md](DEVELOPMENT_RULES.md) - Development guidelines
- [æ§åˆ¶å™¨é–‹ç™¼èˆ‡Gitç®¡ç†ç­–ç•¥.md](æ§åˆ¶å™¨é–‹ç™¼èˆ‡Gitç®¡ç†ç­–ç•¥.md) - Controller development
- [generate_simulink_framework.md](generate_simulink_framework.md) - Framework generation details

---

## ğŸ“… Version History

| Date       | Version | Changes                                    |
|------------|---------|-------------------------------------------|
| 2025-10-09 | 1.0     | Initial project structure documentation   |
| 2025-10-09 | 1.1     | Added file reorganization (framework/design split) |

---

**Maintained by**: Control System Development Team
**Contact**: (Add contact information)
